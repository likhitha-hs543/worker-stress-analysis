<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Worker Stress Analysis Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1>ðŸ§  Worker Stress Analysis Dashboard</h1>
            <div class="timestamp" id="currentTime"></div>
        </header>

        <!-- Main Grid -->
        <div class="dashboard-grid">
            <!-- Video Feed Section -->
            <div class="card video-section">
                <h2>ðŸ“¹ Live Video Feed</h2>
                <div class="video-container">
                    <img src="{{ url_for('video_feed') }}" alt="Video Feed" class="video-feed">
                </div>
            </div>

            <!-- Current Status Section -->
            <div class="card status-section">
                <h2>ðŸ“Š Current Status</h2>
                
                <div class="status-item stress-level-display">
                    <div class="stress-indicator" id="stressIndicator">
                        <div class="stress-level-text" id="stressLevelText">CALM</div>
                        <div class="stress-score" id="stressScore">0.00</div>
                    </div>
                </div>

                <div class="status-grid">
                    <div class="status-item">
                        <div class="status-label">ðŸ˜Š Face Emotion</div>
                        <div class="status-value" id="faceEmotion">neutral</div>
                        <div class="status-confidence" id="faceConfidence">0.00</div>
                    </div>

                    <div class="status-item">
                        <div class="status-label">ðŸŽ¤ Speech Emotion</div>
                        <div class="status-value" id="speechEmotion">neutral</div>
                        <div class="status-confidence" id="speechConfidence">0.00</div>
                    </div>
                </div>

                <div class="stress-bar-container">
                    <div class="stress-bar-label">Stress Level</div>
                    <div class="stress-bar">
                        <div class="stress-bar-fill" id="stressBarFill"></div>
                    </div>
                    <div class="stress-bar-markers">
                        <span>Relaxed</span>
                        <span>Calm</span>
                        <span>Mild</span>
                        <span>Moderate</span>
                        <span>High</span>
                    </div>
                </div>
            </div>

            <!-- Emotion Classification Section -->
            <div class="card emotion-classification-section">
                <h2>ðŸŽ­ Emotion Classification</h2>
                
                <div class="emotion-cards">
                    <div class="emotion-card face-emotion-card">
                        <div class="emotion-icon">ðŸ˜Š</div>
                        <div class="emotion-title">Face Emotion</div>
                        <div class="emotion-name" id="faceEmotionName">neutral</div>
                        <div class="emotion-confidence-bar">
                            <div class="emotion-confidence-fill" id="faceConfidenceBar"></div>
                        </div>
                        <div class="emotion-confidence-text" id="faceConfidenceText">0%</div>
                    </div>

                    <div class="emotion-card speech-emotion-card">
                        <div class="emotion-icon">ðŸŽ¤</div>
                        <div class="emotion-title">Speech Emotion</div>
                        <div class="emotion-name" id="speechEmotionName">neutral</div>
                        <div class="emotion-confidence-bar">
                            <div class="emotion-confidence-fill" id="speechConfidenceBar"></div>
                        </div>
                        <div class="emotion-confidence-text" id="speechConfidenceText">0%</div>
                    </div>
                </div>

                <div class="emotion-legend">
                    <div class="legend-item">
                        <span class="legend-color happy"></span> Happy
                    </div>
                    <div class="legend-item">
                        <span class="legend-color neutral"></span> Neutral
                    </div>
                    <div class="legend-item">
                        <span class="legend-color sad"></span> Sad
                    </div>
                    <div class="legend-item">
                        <span class="legend-color angry"></span> Angry
                    </div>
                    <div class="legend-item">
                        <span class="legend-color fear"></span> Fear
                    </div>
                </div>
            </div>

            <!-- Statistics Section -->
            <div class="card stats-section">
                <h2>ðŸ“ˆ Statistics</h2>
                
                <div class="stat-card">
                    <div class="stat-label">Average Stress</div>
                    <div class="stat-value" id="avgStress">0.00</div>
                </div>

                <div class="stat-card">
                    <div class="stat-label">Trend</div>
                    <div class="stat-value" id="trend">stable</div>
                </div>

                <div class="stat-card">
                    <div class="stat-label">Total Samples</div>
                    <div class="stat-value" id="totalSamples">0</div>
                </div>

                <div class="stat-card">
                    <div class="stat-label">Max Stress</div>
                    <div class="stat-value" id="maxStress">0.00</div>
                </div>
            </div>

            <!-- Charts Section -->
            <div class="card chart-section">
                <h2>ðŸ“‰ Stress History</h2>
                <div class="chart-container">
                    <canvas id="stressChart"></canvas>
                </div>
            </div>

            <div class="card chart-section">
                <h2>ðŸŽ­ Face Emotion Distribution</h2>
                <div class="chart-container">
                    <canvas id="emotionChart"></canvas>
                </div>
                <div class="chart-info">
                    Shows distribution of detected face emotions over the last hour
                </div>
            </div>

            <!-- History Table -->
            <div class="card history-section">
                <h2>ðŸ“‹ Recent History</h2>
                <div class="table-container">
                    <table class="history-table">
                        <thead>
                            <tr>
                                <th>Time</th>
                                <th>Stress Level</th>
                                <th>Score</th>
                                <th>Face</th>
                                <th>Speech</th>
                            </tr>
                        </thead>
                        <tbody id="historyTableBody">
                            <!-- History rows will be inserted here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
</body>
</html>
